{% extends "base.html" %}

{% block title %}‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‚Äî Print Shop{% endblock %}

{% block breadcrumb %}‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-6">

  <h1 class="text-xl font-semibold text-gray-900">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h1>

  <form method="post">
    {% csrf_token %}

    <!-- Email section -->
    <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
      <h2 class="text-base font-semibold text-gray-800 mb-4">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</h2>

      <div class="flex items-center gap-4 mb-4">
        <span class="text-sm text-gray-700 w-32">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="notification_email_enabled" value="1"
                 {% if s.notification_email_enabled == "1" %}checked{% endif %}
                 class="text-indigo-600">
          <span class="text-sm text-green-700 font-medium">‡πÄ‡∏õ‡∏¥‡∏î</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="notification_email_enabled" value="0"
                 {% if s.notification_email_enabled != "1" %}checked{% endif %}
                 class="text-indigo-600">
          <span class="text-sm text-red-700 font-medium">‡∏õ‡∏¥‡∏î</span>
        </label>
      </div>

      <div class="mb-4">
        <label class="block text-sm text-gray-700 mb-1">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á/‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</label>
        <input type="email" name="notification_email_recipient"
               value="{{ s.notification_email_recipient }}"
               placeholder="owner@example.com"
               class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
        <p class="text-xs text-gray-500 mt-1">‡∏£‡∏±‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</p>
      </div>

      <div class="flex items-center gap-3">
        <button type="button"
                hx-post="{% url 'notifications:test_email' %}"
                hx-target="#email-test-result"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md border border-gray-300 transition-colors">
          ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        </button>
        <span id="email-test-result"></span>
      </div>

      <p class="text-xs text-gray-400 mt-3">
        ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SMTP ‡πÉ‡∏ô <code>.env</code>: EMAIL_HOST, EMAIL_PORT, EMAIL_HOST_USER, EMAIL_HOST_PASSWORD
      </p>
    </div>

    <!-- LINE customers section -->
    <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
      <h2 class="text-base font-semibold text-gray-800 mb-4">LINE (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</h2>

      <div class="flex items-center gap-4 mb-4">
        <span class="text-sm text-gray-700 w-32">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="notification_line_enabled" value="1"
                 {% if s.notification_line_enabled == "1" %}checked{% endif %}
                 class="text-indigo-600">
          <span class="text-sm text-green-700 font-medium">‡πÄ‡∏õ‡∏¥‡∏î</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="notification_line_enabled" value="0"
                 {% if s.notification_line_enabled != "1" %}checked{% endif %}
                 class="text-indigo-600">
          <span class="text-sm text-red-700 font-medium">‡∏õ‡∏¥‡∏î</span>
        </label>
      </div>

      <p class="text-sm text-gray-600">
        ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE Bot:
        <span class="font-semibold text-indigo-700">{{ line_customer_count }} ‡∏£‡∏≤‡∏¢</span>
      </p>
      <p class="text-xs text-gray-400 mt-1">
        ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£ Follow LINE Official Account ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
      </p>
    </div>

    <!-- LINE staff section -->
    <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
      <h2 class="text-base font-semibold text-gray-800 mb-4">LINE (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‚Äî ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)</h2>

      {% if request.user.line_user_id %}
        <div class="flex items-center gap-3 mb-3">
          <span class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-green-100 text-green-800">
            <span>‚úì</span> ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß: {{ request.user.line_display_name|default:request.user.line_user_id }}
          </span>
        </div>
        <form method="post" action="{% url 'accounts:line_disconnect' %}" class="inline">
          {% csrf_token %}
          <button type="submit"
                  class="px-3 py-1.5 text-sm text-red-600 hover:text-red-800 border border-red-200 hover:bg-red-50 rounded-md transition-colors">
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
          </button>
        </form>
      {% else %}
        <p class="text-sm text-gray-600 mb-3">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE ‚Äî ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</p>
        <a href="{% url 'accounts:line_login' %}"
           class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-500 hover:bg-green-600 rounded-md transition-colors">
          <span>üì±</span> ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE
        </a>
        {% if not request.user.is_owner %}
          <p class="text-xs text-gray-400 mt-2">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</p>
        {% endif %}
      {% endif %}
    </div>

    <!-- Task thresholds -->
    <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
      <h2 class="text-base font-semibold text-gray-800 mb-4">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>

      <div class="space-y-4">
        <div>
          <label class="block text-sm text-gray-700 mb-1">
            ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡∏ß‡∏±‡∏ô)
          </label>
          <input type="number" name="payment_reminder_days"
                 value="{{ s.payment_reminder_days }}" min="0" max="30"
                 class="w-24 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
          <p class="text-xs text-gray-500 mt-1">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏≥‡∏£‡∏∞ N ‡∏ß‡∏±‡∏ô</p>
        </div>

        <div>
          <label class="block text-sm text-gray-700 mb-1">
            ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏ö‡∏ö (‡∏ß‡∏±‡∏ô)
          </label>
          <input type="number" name="approval_reminder_days"
                 value="{{ s.approval_reminder_days }}" min="1" max="30"
                 class="w-24 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
          <p class="text-xs text-gray-500 mt-1">‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ã‡πâ‡∏≥‡∏ñ‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà "‡∏£‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" ‡∏ô‡∏≤‡∏ô N ‡∏ß‡∏±‡∏ô</p>
        </div>
      </div>
    </div>

    <div class="flex justify-end">
      <button type="submit"
              class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-md transition-colors">
        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
      </button>
    </div>
  </form>
</div>
{% endblock %}
